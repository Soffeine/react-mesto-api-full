(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{29:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(18),s=n.n(o),i=(n(29),n(23)),r=n(10),u=n(2),l=n.p+"static/media/add__button.eef2e85c.svg",p=n.p+"static/media/header-logo.b430ba41.svg",d=n(8),j=n(0);var m=function(e){var t=e.email,n=e.linkName,a=e.link,c=e.onSignOut;return Object(j.jsxs)("header",{className:"header",children:[Object(j.jsx)("img",{src:p,className:"header__logo",alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u041c\u0435\u0441\u0442\u043e"}),Object(j.jsxs)("div",{className:"header__links-container",children:[Object(j.jsx)("p",{className:"header__link",children:t}),Object(j.jsx)(d.b,{to:a,className:"header__link",onClick:c,children:n})]})]})},b=c.a.createContext();var h=function(e){var t=e.card,n=e.onCardClick,c=e.onCardLike,o=e.onCardDelete,s=t.name,i=t.link,r=t.likes,u=Object(a.useContext)(b),l=t.owner._id===u._id,p="place__delete-button ".concat(l?"":"place__delete-button_hidden"),d=t.likes.some((function(e){return e._id===u._id})),m="place__like-button ".concat(d?"place__like-button_active":"");return Object(j.jsxs)("div",{className:"place",children:[Object(j.jsx)("img",{className:"place__image",src:i,alt:s,onClick:function(){return n(t)}}),Object(j.jsx)("button",{type:"button",className:p,onClick:function(){return o(t)}}),Object(j.jsxs)("div",{className:"place__caption",children:[Object(j.jsx)("h2",{className:"place__title",children:s}),Object(j.jsxs)("div",{className:"place__like-status-container",children:[Object(j.jsx)("button",{type:"button",className:m,onClick:function(){return c(t)}}),Object(j.jsx)("p",{className:"place__like-counter",children:r.length})]})]})]})};var f=function(e){var t=e.onEditProfileClick,n=e.onAddPlaceClick,c=e.onAvatarClick,o=e.onCardClick,s=e.cards,i=e.onCardLike,r=e.onCardDelete,u=e.userEmail,p=e.onSignOut,d=Object(a.useContext)(b);return Object(j.jsxs)("main",{children:[Object(j.jsx)(m,{link:"/sign-in",linkName:"\u0412\u044b\u0439\u0442\u0438",email:u,onSignOut:p}),Object(j.jsxs)("section",{className:"profile",children:[Object(j.jsxs)("div",{className:"profile__image",children:[Object(j.jsx)("img",{src:d.avatar,className:"profile__photo",id:"userAvatar",alt:"\u0424\u043e\u0442\u043e \u043f\u0440\u043e\u0444\u0438\u043b\u044f"}),Object(j.jsx)("button",{type:"button",className:"profile__edit-sign",onClick:c})]}),Object(j.jsxs)("div",{className:"profile__info",children:[Object(j.jsx)("h1",{className:"profile__name",id:"name",children:d.name}),Object(j.jsx)("button",{type:"button",className:"profile__edit-button",onClick:t}),Object(j.jsx)("p",{className:"profile__description",id:"description",children:d.about})]}),Object(j.jsx)("button",{type:"button",className:"profile__add-button",onClick:n,children:Object(j.jsx)("img",{src:l,alt:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e"})})]}),Object(j.jsx)("section",{className:"places",children:s.map((function(e){return Object(j.jsx)(h,{card:e,onCardClick:o,cards:s,onCardLike:i,onCardDelete:r},e._id)}))})]})};var O=function(){return Object(j.jsx)("footer",{className:"footer",children:Object(j.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Mesto Russia"})})};var _=function(e){var t=e.email,n=e.password,a=e.title,c=e.buttonText,o=e.children,s=e.onChangeEmail,i=e.onChangePassword,r=e.onSubmit;return Object(j.jsxs)("form",{className:"auth-form",onSubmit:r,children:[Object(j.jsxs)("div",{className:"auth-form__container",children:[Object(j.jsx)("h2",{className:"auth-form__title",children:a}),Object(j.jsx)("input",{className:"auth-form__input",type:"email",placeholder:"Email",id:"email",name:"email",value:t||"",onChange:s,required:!0}),Object(j.jsx)("span",{className:"auth-form__span"}),Object(j.jsx)("input",{className:"auth-form__input",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"password",name:"password",value:n||"",onChange:i,required:!0}),Object(j.jsx)("span",{className:"auth-form__span"}),Object(j.jsx)("button",{className:"auth-form__submit",type:"submit",children:c})]}),o]})};var g=function(e){var t=e.onRegister,n=Object(a.useState)(""),c=Object(u.a)(n,2),o=c[0],s=c[1],i=Object(a.useState)(""),r=Object(u.a)(i,2),l=r[0],p=r[1];return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(m,{link:"/sign-in",linkName:"\u0412\u043e\u0439\u0442\u0438",email:""}),Object(j.jsx)(_,{email:o,password:l,title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonText:"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",onChangeEmail:function(e){s(e.target.value)},onChangePassword:function(e){p(e.target.value)},onSubmit:function(e){e.preventDefault(),t(l,o)},children:Object(j.jsxs)("p",{className:"auth-form__signin",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(j.jsx)(d.b,{to:"/sign-in",className:"auth-form__signin_link",children:"\u0412\u043e\u0439\u0442\u0438"})]})})]})};var x=function(e){var t=e.onLogin,n=Object(a.useState)(""),c=Object(u.a)(n,2),o=c[0],s=c[1],i=Object(a.useState)(""),r=Object(u.a)(i,2),l=r[0],p=r[1];return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(m,{link:"/sign-up",linkName:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",email:""}),Object(j.jsx)(_,{password:l,email:o,title:"\u0412\u0445\u043e\u0434",buttonText:"\u0412\u043e\u0439\u0442\u0438",onChangeEmail:function(e){s(e.target.value)},onChangePassword:function(e){p(e.target.value)},onSubmit:function(e){e.preventDefault(),t(l,o)}})]})};var v=function(e){var t=e.card,n=e.isOpened,a=e.popupName,c=e.onClose,o=t.link,s=t.name;return Object(j.jsx)("div",{className:n?"popup popup_opened popup-".concat(a):"popup popup-".concat(a),children:Object(j.jsxs)("div",{className:"popup-image__container",children:[Object(j.jsx)("button",{type:"button",className:"popup__close-button popup-image__close-button",onClick:c}),Object(j.jsx)("img",{className:"popup-image__picture",src:o.toString(),alt:"\u0444\u043e\u0442\u043e \u043c\u0435\u0441\u0442\u0430"}),Object(j.jsx)("p",{className:"popup-image__caption",children:s})]})})};var C=function(e){var t=e.name,n=e.title,a=e.children,c=e.buttonText,o=e.isOpened,s=e.onClose,i=e.onSubmit;return Object(j.jsx)("div",{className:o?"popup popup_opened popup-".concat(t):"popup popup-".concat(t),children:Object(j.jsxs)("div",{className:"popup__container",children:[Object(j.jsx)("button",{type:"button",className:"popup__close-button popup-edit__close-button",onClick:s}),Object(j.jsxs)("form",{className:"popup-form",name:t,id:"popup-".concat(t,"-form"),onSubmit:i,children:[Object(j.jsx)("h2",{className:"popup-form__heading",children:n}),a,Object(j.jsx)("button",{type:"submit",className:"popup__button popup__button_valid",name:"addSubmit",children:c})]})]})})};var N=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateUser,o=Object(a.useContext)(b),s=Object(a.useState)(""),i=Object(u.a)(s,2),r=i[0],l=i[1],p=Object(a.useState)(""),d=Object(u.a)(p,2),m=d[0],h=d[1];return Object(a.useEffect)((function(){l(o.name),h(o.about)}),[o,t]),Object(a.useEffect)((function(){l(""),h("")}),[]),Object(j.jsxs)(C,{name:"edit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpened:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:r,about:m})},children:[Object(j.jsx)("input",{type:"text",value:r,onChange:function(e){l(e.target.value)},className:"popup-form__information popup-form__information_input_name",placeholder:"\u0418\u043c\u044f",name:"name",minLength:"2",maxLength:"20",required:!0}),Object(j.jsx)("span",{className:"popup__error-message"}),Object(j.jsx)("input",{type:"text",value:m,onChange:function(e){h(e.target.value)},className:"popup-form__information popup-form__information_input_description",placeholder:"\u0427\u0435\u043c \u0432\u044b \u0437\u0430\u043d\u0438\u043c\u0430\u0435\u0442\u0435\u0441\u044c?",name:"about",minLength:"2",maxLength:"200",required:!0}),Object(j.jsx)("span",{className:"popup__error-message"})]})};var k=function(e){var t=e.isOpen,n=e.onClose,c=e.onAddPlace,o=Object(a.useState)(""),s=Object(u.a)(o,2),i=s[0],r=s[1],l=Object(a.useState)(""),p=Object(u.a)(l,2),d=p[0],m=p[1];return Object(j.jsxs)(C,{name:"add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpened:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:i,link:d}),r(""),m("")},children:[Object(j.jsx)("input",{type:"text",onChange:function(e){r(e.target.value)},className:"popup-form__information popup-form__information_input_place-name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:i||"",name:"name",minLength:"2",maxLength:"30",required:!0}),Object(j.jsx)("span",{className:"popup__error-message"}),Object(j.jsx)("input",{onChange:function(e){m(e.target.value)},value:d||"",className:"popup-form__information popup-form__information_input_link-image",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",name:"link",type:"url",required:!0}),Object(j.jsx)("span",{className:"popup__error-message"})]})};var S=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateAvatar,o=Object(a.useRef)(null);return Object(j.jsxs)(C,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpened:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({avatar:o.current.value})},children:[Object(j.jsx)("input",{ref:o,className:"popup-form__information popup-form__information_input_avatar-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0444\u043e\u0442\u043e",name:"avatar",type:"url",required:!0}),Object(j.jsx)("span",{className:"popup__error-message"})]})},y=n(21),P=n(22),E=new(function(){function e(t){Object(y.a)(this,e),this._url=t.url,this._headers=t.headers}return Object(P.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._url,"/users/me"),{method:"GET",headers:this._headers}).then(this._getResponseData)}},{key:"getPlaceInfo",value:function(){return fetch("".concat(this._url,"/cards"),{method:"GET",headers:this._headers}).then(this._getResponseData)}},{key:"editProfileInfo",value:function(e){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._getResponseData)}},{key:"editAvatar",value:function(e){return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._getResponseData)}},{key:"addNewCard",value:function(e){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._getResponseData)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._getResponseData)}},{key:"changeLikeStatus",value:function(e,t){return fetch("".concat(this._url,"/cards/likes/").concat(e),{method:t?"PUT":"DELETE",headers:this._headers}).then(this._getResponseData)}}]),e}())({url:"http://api.mesto.soffeine.nomoredomains.rocks",headers:{authorization:"7f564866-b8ba-4557-8c91-b7d4f8327f3b","Content-Type":"application/json"}}),T=n(3),w=n(24),D=["component"],I=function(e){var t=e.component,n=Object(w.a)(e,D);return Object(j.jsx)(T.b,{children:function(){return n.loggedIn?Object(j.jsx)(t,Object(r.a)({},n)):Object(j.jsx)(T.a,{to:"./sign-in"})}})};var L=function(e){var t=e.data,n=e.isOpen,a=e.onClose;return Object(j.jsx)("div",{className:n?"popup popup_opened ":"popup",children:Object(j.jsxs)("div",{className:"popup__container",children:[Object(j.jsx)("button",{type:"button",className:"popup__close-button popup-edit__close-button",onClick:a}),Object(j.jsx)("img",{className:"popup__image",src:t.image,alt:"\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"}),Object(j.jsx)("p",{className:"popup__text",children:t.text})]})})},A="http://api.mesto.soffeine.nomoredomains.rocks",R=function(e){return e.ok?e.json():Promise.reject(e.status)},U=n.p+"static/media/onRegisterError.064903fa.svg",q=n.p+"static/media/onRegisterSuccess.bd528945.svg";var J=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(!1),s=Object(u.a)(o,2),l=s[0],p=s[1],d=Object(a.useState)(!1),m=Object(u.a)(d,2),h=m[0],_=m[1],C=Object(a.useState)({isImagePopupOpen:!1,selectedCard:""}),y=Object(u.a)(C,2),P=y[0],w=y[1],D=Object(a.useState)({}),J=Object(u.a)(D,2),F=J[0],B=J[1],G=Object(a.useState)([]),z=Object(u.a)(G,2),H=z[0],M=z[1],K=Object(a.useState)(!1),Q=Object(u.a)(K,2),V=Q[0],W=Q[1],X=Object(T.g)(),Y=Object(a.useState)(!1),Z=Object(u.a)(Y,2),$=Z[0],ee=Z[1],te=Object(a.useState)({}),ne=Object(u.a)(te,2),ae=ne[0],ce=ne[1],oe=Object(a.useState)(""),se=Object(u.a)(oe,2),ie=se[0],re=se[1],ue={image:U,text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."},le={image:q,text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"};function pe(e){ee(!0),ce(e)}function de(){c(!1),_(!1),p(!1),w((function(e){return Object(r.a)(Object(r.a)({},e),{},{isImagePopupOpen:!1})})),ee(!1)}var je=function(e){return function(e){return fetch("".concat(A,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(R).then((function(e){return e}))}(e).then((function(e){var t=e.data;W(!0),re(t.email)})).catch((function(e){console.log(e)}))};return Object(a.useEffect)((function(){var e=localStorage.getItem("jwt");e&&je(e)}),[V]),Object(a.useEffect)((function(){V&&X.push("/")}),[V,X]),Object(a.useEffect)((function(){Promise.all([E.getUserInfo(),E.getPlaceInfo()]).then((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];B(n),M(a)})).catch((function(e){return console.log("\u0423\u043f\u0441, \u043e\u0448\u0438\u0431\u043e\u0447\u043a\u0430 ".concat(e))}))}),[]),Object(j.jsx)(b.Provider,{value:F,children:Object(j.jsxs)("div",{className:"page",children:[Object(j.jsxs)(T.d,{children:[Object(j.jsx)(I,{exact:!0,path:"/",loggedIn:V,component:f,onEditProfileClick:function(){c(!0)},onAddPlaceClick:function(){p(!0)},onAvatarClick:function(){_(!0)},onCardClick:function(e){w((function(t){return Object(r.a)(Object(r.a)({},t),{},{isImagePopupOpen:!0,selectedCard:e})}))},cards:H,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===F._id}));E.changeLikeStatus(e._id,!t).then((function(t){M((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onCardDelete:function(e){E.deleteCard(e._id).then((function(){M((function(){return H.filter((function(t){return t._id!==e._id}))}))})).catch((function(e){console.log(e)}))},userEmail:ie,onSignOut:function(){W(!1),localStorage.removeItem("jwt")}}),Object(j.jsx)(T.b,{path:"/sign-up",children:Object(j.jsx)(g,{onRegister:function(e,t){(function(e,t){return fetch("".concat(A,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then(R).then((function(e){var t=e.data;console.log(t),localStorage.setItem("email",t.email)}))})(e,t).then((function(){pe(le),X.push("/sign-in")})).catch((function(e){pe(ue),console.log(e)}))}})}),Object(j.jsx)(T.b,{path:"/sign-in",children:Object(j.jsx)(x,{onLogin:function(e,t){return function(e,t){return fetch("".concat(A,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then(R).then((function(e){localStorage.setItem("jwt",e.token)}))}(e,t).then((function(){W(!0),X.push("/")})).catch((function(){pe(ue)}))}})})]}),Object(j.jsx)(O,{}),Object(j.jsx)(N,{isOpen:n,onClose:de,onUpdateUser:function(e){E.editProfileInfo(e).then((function(e){B(e),de()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(k,{isOpen:l,onClose:de,onAddPlace:function(e){E.addNewCard(e).then((function(e){M([e].concat(Object(i.a)(H))),de()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(S,{isOpen:h,onClose:de,onUpdateAvatar:function(e){E.editAvatar(e).then((function(e){B(e),de()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(v,{card:P.selectedCard,isOpened:P.isImagePopupOpen,popupName:"image",onClose:de}),Object(j.jsx)(L,{data:ae,isOpen:$,onClose:de})]})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),o(e),s(e)}))};s.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(d.a,{children:Object(j.jsx)(J,{})})}),document.getElementById("root")),F()}},[[36,1,2]]]);
//# sourceMappingURL=main.507b423d.chunk.js.map